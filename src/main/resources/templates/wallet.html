<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head>
    <meta charset="UTF-8">
    <title>Wallet</title>
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/wallet.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
</head>
<body>
<aside class="sidebar">
    <a href="/home" class="nav-item"><h1>Menu</h1></a>

    <a href="/children" class="nav-item">My Kids</a>
    <a href="/wallet" class="nav-item">Wallet</a>

    <h1>Settings</h1>

    <a href="/profile" class="nav-item">Edit Profile</a>
    <a href="/logout" class="nav-item">Logout</a>
</aside>
<div class="wallet-container" th:with="p=${parent}">
    <section class="main-section">
        <div class="card profile-card">
    <header>
        <h1>Wallet</h1>
        <p th:text="${p != null ? p.firstName + ' ' + p.lastName : 'Guest'}">Parent Name</p>
    </header>

    <!-- ðŸ’° Balance Section -->
    <section class="balance">
        <h2>Available Balance</h2>
        <p class="amount" th:text="${p.wallet.balance + ' ' + p.wallet.currency}">
            0.00 EUR
        </p>
    </section>

    <!-- ðŸ’µ Add Money Section -->
            <section class="actions">
                <form th:action="@{/wallet}" th:object="${walletDepositRequest}" method="post" class="add-money-form">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />

                    <label for="amount">Enter Amount:</label>
                    <input type="number" id="amount" th:field="*{amount}" min="1" step="0.10" placeholder="0.00" required/>

                    <button type="submit" class="primary">Add Money</button>
                </form>
                <div th:if="${successMessage}" class="alert alert-success" th:text="${successMessage}"
                     style="margin-top: 12px; padding: 10px 14px; border-radius: 6px; background: #d1e7dd; color: #0f5132; border: 1px solid #badbcc;"></div>
                <div th:if="${errorMessage}" class="alert alert-danger" th:text="${errorMessage}"
                     style="margin-top: 12px; padding: 10px 14px; border-radius: 6px; background: #f8d7da; color: #842029; border: 1px solid #f5c2c7;"></div>
            </section>

        <section class="transactions" th:if="${transactions != null}">
            <h2>Transaction History</h2>
            <p style="margin-bottom: 12px; color: #666; font-size: 0.95rem;">Showing latest 5 transactions.</p>
            <table class="transaction-table">
                <thead>
                <tr>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Amount</th>
                </tr>
                </thead>
                <tbody id="transactionBody">
                <tr th:each="t : ${transactions}">
                    <td th:text="${#temporals.format(t.createdOn, 'dd-MM-yyyy HH:mm')}">12-10-2025</td>
                    <td th:text="${t.description}">Deposit</td>
                    <td th:text="${t.amount + ' ' + p.wallet.currency}">10.00 EUR</td>
                </tr>
                <tr th:if="${#lists.isEmpty(transactions)}">
                    <td colspan="3" >No transactions yet.</td>
                </tr>
                </tbody>
            </table>
        </section>


    </section>
</div>
    </section>
<script>
    document.addEventListener("DOMContentLoaded", () => {
        const successAlert = document.querySelector(".alert-success");
        if (successAlert) {
            setTimeout(() => {
                successAlert.style.transition = "opacity 0.5s ease";
                successAlert.style.opacity = "0";
                setTimeout(() => successAlert.remove(), 500);
            }, 5000);
        }
    });
</script>

</body>
</html>
